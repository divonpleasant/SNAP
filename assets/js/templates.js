/*
This creates an object containing all the templates for application and 
processing of various template literals and text blobs to be used throughout
the SNAP utility.

Usage Notes:
The context argument should be an array with position-dependent context data
that permits template re-use for non-dynamic values (i.e. data that cannot be
retrieved from the form or cookies at initialization). An examples of would be
user actions (link clicked, field hovered, etc).

Context arrays can be arbitrarily large, but overloading arrays is discouraged.
Processing contexts should never be performed within this function. Use context
only to prevent duplicating templates that share 80% or more common verbiage.

The template object generated by this function should be re-initialized for
each top-level functional category and context is only available to each
instance upon initialization. 
*/
function generateTemplates(context) {
    debugmsg(4, 'generateTemplates context: ' + context);
    serial_strings = proc_template_serial(document.getElementById('serial').value);
    cct_strings = proc_template_cct(document.getElementById('cct').value);
    this.templates = {
        "email": {
            "canada-service-request": {
                "name": "Canada Service Request",
                "recipient": "service_canada@zeiss.com",
                "cc": [],
                "bcc": [],
                "subject": `Service Request - Calgary, AB${cct_strings[2]}${serial_strings[0]}`,
                "body": `The following Canadian customer needs a Service Request, please.

Business Location Details

    Account Name: ${document.getElementById('account').value}
    Address: ${document.getElementById('instrument-address').value}
    Serial Number: ${document.getElementById('serial').value}
    Instrument Description: ${document.getElementById('instrument-model').value}
    Windows Version: ${document.getElementById('windows-version').value}
    
Contact Details

    Contact Name: ${document.getElementById('local-contact-person').value}
    Phone Number: ${document.getElementById('phone').value}
    Email Address: ${document.getElementById('email').value}
    Problem Description: ${document.getElementById('description').value}
    Troubleshooting Performed: ${document.getElementById('troubleshooting-performed').value}

Regards,
${email_sig}`
            },
            "parts-proceed": {
                "name": "Parts Order Request",
                "recipient": "c.osparts@zeiss.com",
                "cc": [],
                "bcc": [],
                "subject": `${cct_strings[1]}${context[0]}${document.getElementById('order-name').value} ${serial_strings[2]}`,
                "body": `Hi Parts Team,

Please ship the following part${context[1]}...

${context[2]}
Customer Care Ticket Number: ${document.getElementById('cct').value}
Instrument Serial Number: ${document.getElementById('serial').value}
Account Name: ${document.getElementById('account').value}
Address:
    Attention: ${document.getElementById('local-contact-person').value}
    ${document.getElementById('instrument-address').value}
Shipment: ${document.getElementById('delivery-type').value}

Thank you for your prompt attention to this matter.

Regards,
${email_sig}`
            },
            "smart-services-confirmation": {
                "name": "Smart Services Confirmation",
                "recipient": `${document.getElementById('email').value}`,
                "cc": [],
                "bcc": [],
                "subject": "Smart Services Request Confirmation",
                "body": `Dear ${document.getElementById('local-contact-person').value},

Thank you for choosing to use Zeiss Smart Services. The information for your ${serial_strings[1]} has been submitted to the Customer Care Advocate Team (CAS) for processing. It may take CAS up to 48 hours to finalize this request at which time you should receive a message from the Zeiss Parts department, containing a unique link to download Zeiss Smart Services. Shortly after this link is provided, a CAS representative will be contacting you and will assist with your installation.

If you have any questions or concerns, please respond to this message or you may reach CAS directly at customeradvocates.med.us@zeiss.com.

Warm Regards,
${email_sig}`
            },
            "smile-device": {
                "name": `${context[0]} Service Request`,
                "recipient": "dl.med-servicerefractive.us@zeiss.com",
                "cc": ["serviceoperationsadmin.med.us@zeiss.com"],
                "bcc": [],
                "subject": `SMILE Device (${context[0]}) Service Request`,
                "body": `Hi Terry,

The following customer needs a service request for a ${context[0]} device, please.

Business Location Details
    Account Name: ${document.getElementById('account').value}
    Address: ${document.getElementById('instrument-address').value}
    Serial Number: ${document.getElementById('serial').value}
Contact Details
    Contact Name: ${document.getElementById('local-contact-person').value}
    Phone Number: ${document.getElementById('phone').value}
    Email Address: ${document.getElementById('email').value}
    Problem Description: ${document.getElementById('description').value}
    Troubleshooting Performed: ${document.getElementById('troubleshooting-performed').value}
    
Regards,
${email_sig}`
            },
            "win-support": {
                "name": "Windows 10/11 Support Information",
                "recipient": `${document.getElementById('email').value}`,
                "cc": [],
                "bcc": [],
                "subject": "Zeiss Windows 10/11 Support",
                "body": `Dear ${document.getElementById('local-contact-person').value},

You are receiving this message because you inquired about Zeiss's intentions regarding Windows 10 and/or Windows 11 support.

The Zeiss HFA3, CIRRUS, CLARUS and PLEX Elite devices are currently shipping with Windows 10 1607 (LTSC). We have extended support from Microsoft for that operating system until October 2026.

This coming calendar year (2025) we plan to start shipping new devices with Windows 10 IoT Enterprise LTSC 2021 as well as making it available as an upgrade pathway for existing devices already deployed. The Windows 10 IoT Enterprise LTSC 2021 operating system will be supported by Microsoft until January 2032.

With regards to Windows 11... Microsoft Windows 11 IoT Enterprise LTSC 2024 is not backwards compatible with the hardware in some of Zeiss's products and will, therefore, require a hardware upgrade. This will require additional engineering time for hardware development and will cost more to upgrade. As a result, Zeiss has made a decision to provide a Windows 10 IoT Enterprise LTSC 2021 based solution that is supported by Microsoft until 2032 ensuring a timely, supported solution is available for our customers.

Warm Regards,
${email_sig}`
            }
        },
        "script": {
        },
        "prompt": {
        },
        "solution": {
        },
        "hint": {
        },
        "reminder": {
        },
        "export": {
        }
    }
}    
