/*
This creates an object containing all the templates for application and 
processing of various template literals and text blobs to be used throughout
the SNAP utility.

Usage Notes:
The context argument should be an array with position-dependent context data
that permits template re-use for non-dynamic values (i.e. data that cannot be
retrieved from the form or cookies at initialization). An examples of would be
user actions (link clicked, field hovered, etc).

Context arrays can be arbitrarily large, but overloading arrays is discouraged.
Processing contexts should never be performed within this function. Use context
only to prevent duplicating templates that share 80% or more common verbiage.

The template object generated by this function should be re-initialized for
each top-level functional category and context is only available to each
instance upon initialization. 
*/
function generateTemplates(context) {
    debugmsg(4, 'generateTemplates context: ' + context);
    serial_strings = proc_template_serial(document.getElementById('serial').value);
    cct_strings = proc_template_cct(document.getElementById('cct').value);
    this.templates = {
        "email": {
            "canada-service-request": {
                "name": "Canada Service Request",
                "recipient": "service_canada@zeiss.com",
                "cc": [],
                "bcc": [],
                "subject": `Service Request - Calgary, AB${cct_strings[2]}${serial_strings[0]}`,
                "body": `The following Canadian customer needs a Service Request, please.

Business Location Details

    Account Name: ${document.getElementById('account').value}
    Address: ${document.getElementById('instrument-address').value}
    Serial Number: ${document.getElementById('serial').value}
    Instrument Description: ${document.getElementById('instrument-model').value}
    Windows Version: ${document.getElementById('windows-version').value}
    
Contact Details

    Contact Name: ${document.getElementById('local-contact-person').value}
    Phone Number: ${document.getElementById('phone').value}
    Email Address: ${document.getElementById('email').value}
    Problem Description: ${document.getElementById('description').value}
    Troubleshooting Performed: ${document.getElementById('troubleshooting-performed').value}

Regards,
${email_sig}`
            },
            "end-of-support": {
                "name": "End of Support Explanation",
                "recipient": `${document.getElementById('email').value}`,
                "cc": [],
                "bcc": [],
                "subject": "End of Support: " + `${context[1]}`,
                "body": `Dear ${document.getElementById('local-contact-person').value},

${serial_strings[0]}

We want to inform you that${context[2]} for the ${context[1]} systems. This change means that we no longer offer technical expertise, parts, or service for these devices. Additionally, it is no longer possible to extend, renew, or create new service agreements for these systems.

${context[3]}If you need guidance on how to manage your ${context[0]} devices or are exploring alternative solutions, our sales team are here to assist you. Please reach out to them at sales.support@zeiss.com. They can provide detailed information on your options and help you find the best path forward for your needs.

${context[4]}Regards,
${email_sig}`
            },
            "parts-request": {
                "name": "Parts Order Request",
                "recipient": "c.osparts@zeiss.com",
                "cc": [],
                "bcc": [],
                "subject": `${cct_strings[1]}${context[0]}${document.getElementById('order-name').value} ${serial_strings[2]}`,
                "body": `Hi Parts Team,

Please ship the following part${context[1]}...

${context[2]}
Customer Care Ticket Number: ${document.getElementById('cct').value}
Instrument Serial Number: ${document.getElementById('serial').value}
Account Name: ${document.getElementById('account').value}
Address:
    Attention: ${document.getElementById('local-contact-person').value}
    ${document.getElementById('instrument-address').value}
Shipment: ${document.getElementById('delivery-type').value}

Thank you for your prompt attention to this matter.

Regards,
${email_sig}`
            },
            "billing-request": {
                "name": "Billing Request",
                "recipient": `${document.getElementById('email').value}`,
                "cc": [],
                "bcc": [],
                "subject": `ZEISS ${context[0]} Request ${serial_strings[2]}`,
                "body": `Dear ${document.getElementById('local-contact-person').value},
According to our records, your ${serial_strings[1]} is currently not covered under Warranty or Service Contract.

In order to proceed with this service request, we will need your approval of the payment method:

        [ a ]  Payment with a Credit Card
        [ b ]  Payment with a Hard Copy Purchase Order (PO)
        
This approval would be for the minimum amount of $${context[1]} USD [${context[2]}]${context[3]}.

If payment is by Credit Card, you will be invoiced after services are performed and/or parts are replaced by a Zeiss Technician.

If payment is by Purchase Order, email the hard copy of the PO to ZEISS MED Service Operations Admin US at billableservicerequest@zeiss.com, or as a reply to this message. Reference the Customer Care Ticket number ${context[4]}and serial number of the Zeiss instrument ${serial_strings[2]}on the Purchase Order to expedite the service request.

The Zeiss Technician will contact the office within ${context[5]} business ${context[6]} to schedule the visit. At which time, they will answer all questions regarding specific prices, hourly rates, and travel time. Or, after discussing pricing with your FSE, you may cancel the service request.

Regards,
${email_sig}`
            },
            "fse-update": {
                "name": "FSE Update Request",
                "recipient": "fieldservicedispatchinquiries.med.us@zeiss.com",
                "cc": [],
                "bcc": [],
                "subject": `Field Service Engineer Status Inquiry - SVO #${context[0]}`,
                "body": `Hi Team,
The customer, ${document.getElementById('local-contact-person').value}, has called requesting a status update on the dispatch of the Field Service Engineer for Service Request #${context[0]}. Can someone please reach out and provide the latest update to the customer?

    Local Contact Person: ${document.getElementById('local-contact-person').value}
    Contact Phone Number: ${document.getElementById('phone').value}${(context[2] === 'p') ? ' (Preferred)' : ''}
    Email Address: ${document.getElementById('email').value}${(context[2] === 'e') ? ' (Preferred)' : ''}
    SVO #: ${context[0]}
    Created On: ${context[1]}

Thank you for your prompt attention to this matter.

Regards,
${email_sig}`
            },
            "smart-services-confirmation": {
                "name": "Smart Services Confirmation",
                "recipient": `${document.getElementById('email').value}`,
                "cc": [],
                "bcc": [],
                "subject": "Smart Services Request Confirmation",
                "body": `Dear ${document.getElementById('local-contact-person').value},

Thank you for choosing to use Zeiss Smart Services. The information for your ${serial_strings[1]} has been submitted to the Customer Care Advocate Team (CAS) for processing. It may take CAS up to 48 hours to finalize this request at which time you should receive a message from the Zeiss Parts department, containing a unique link to download Zeiss Smart Services. Shortly after this link is provided, a CAS representative will be contacting you and will assist with your installation.

If you have any questions or concerns, please respond to this message or you may reach CAS directly at customeradvocates.med.us@zeiss.com.

Warm Regards,
${email_sig}`
            },
            "smile-device": {
                "name": `${context[0]} Service Request`,
                "recipient": "dl.med-servicerefractive.us@zeiss.com",
                "cc": ["serviceoperationsadmin.med.us@zeiss.com"],
                "bcc": [],
                "subject": `SMILE Device (${context[0]}) Service Request`,
                "body": `Hi Terry,

The following customer needs a service request for a ${context[0]} device, please.

Business Location Details
    Account Name: ${document.getElementById('account').value}
    Address: ${document.getElementById('instrument-address').value}
    Serial Number: ${document.getElementById('serial').value}
Contact Details
    Contact Name: ${document.getElementById('local-contact-person').value}
    Phone Number: ${document.getElementById('phone').value}
    Email Address: ${document.getElementById('email').value}
    Problem Description: ${document.getElementById('description').value}
    Troubleshooting Performed: ${document.getElementById('troubleshooting-performed').value}
    
Regards,
${email_sig}`
            },
            "win-support": {
                "name": "Windows 10/11 Support Information",
                "recipient": `${document.getElementById('email').value}`,
                "cc": [],
                "bcc": [],
                "subject": "Zeiss Windows 10/11 Support",
                "body": `Dear ${document.getElementById('local-contact-person').value},

You are receiving this message because you inquired about Zeiss's intentions regarding Windows 10 and/or Windows 11 support.

The Zeiss HFA3, CIRRUS, CLARUS and PLEX Elite devices are currently shipping with Windows 10 1607 (LTSC). We have extended support from Microsoft for that operating system until October 2026.

This coming calendar year (2025) we plan to start shipping new devices with Windows 10 IoT Enterprise LTSC 2021 as well as making it available as an upgrade pathway for existing devices already deployed. The Windows 10 IoT Enterprise LTSC 2021 operating system will be supported by Microsoft until January 2032.

With regards to Windows 11... Microsoft Windows 11 IoT Enterprise LTSC 2024 is not backwards compatible with the hardware in some of Zeiss's products and will, therefore, require a hardware upgrade. This will require additional engineering time for hardware development and will cost more to upgrade. As a result, Zeiss has made a decision to provide a Windows 10 IoT Enterprise LTSC 2021 based solution that is supported by Microsoft until 2032 ensuring a timely, supported solution is available for our customers.

Warm Regards,
${email_sig}`
            }
        },
        "script": {
            "greeting": {
                "default": {
                    "queue": "Hello! Thank you for calling Zeiss Technical Support. May I have the serial number of your instrument, please?",
                    "callback": `Hello! This is ${casual_name} from Zeiss Technical Support, returning a call for assistance on a Zeiss instrument or software.`,
                    "voicemail": `Hello, this is ${casual_name} calling from Zeiss Technical Support. ${(document.getElementById('local-contact-person').value !== '') ? 'This message is for' + document.getElementById('local-contact-person').value + ' ' : ''}Sorry to have missed you.`,
                    "outgoing": `Hello! This is ${casual_name} calling from Zeiss Technical Support.${(document.getElementById('local-contact-person').value !== '') ? "I'm trying to reach " + document.getElementById('local-contact-person').value + ", please." : ''}`
                },
                "user": {
                    "queue": `${(curr_date.getHours() <= 12) ? 'Good morning! ' : ''}Thank you for calling Zeiss Technical Support, this is ${casual_name}. Who do I have the pleasure of speaking with? [ENTER POC.] May I have the serial number of your instrument or an existing ticket number to reference?`
                }                    
            }
        },
        "process": {
            "call-types": {
                "general": {
                    "default": `<h1>Generic Troubleshooting Call</h1>
<ol>
    <li><a href="#top">Gather customer and device information</a></li>
    <li>Follow <a href="#checklist">Technical Support Call Checklist</a> to troubleshoot issue</li>
    <li>${TRef.cct_in_crm} from <a href="#rafta">Request Notes</a> and <a href="#internal">Internal Notes</a></li>
    <li><a href="#export">Export</a> SNAP log and attach to CCT</li>
    <li>Close ticket if applicable.</li>
</ol>`,
                    "delivery-doa": `<h1>Delivery Dead On Arrival</h1>
<ol>
    <li>Dead On Arrival (DOA) issues for new instruments are generally reported by Technical Transportation (TechTrans) while onsite performing 'white glove' delivery service</li>
    <li>Instrument may not be connected to the network and remote troubleshooting may not be possible</li>
    <li>DOA complaints require the ${TRef.crm} CCT to be flagged as a Sustaining Ticket (use Critical Incident field and select 'Investig. required, unusual occurrence')</li>
    <li>Note any relevant information provided by TechTrans in the ticket description (e.g. initialization step where failure occurred, error messages, condition of the packaging upon delivery)</li>
    <li>Otherwise treat as a standard onsite dispatch</li>
</ol>`,
                    "fse-follow-up": `<h1>FSE Follow-Up</h1>
<ol>
    <li>Apologize to customer for any delay</li>
    <li>Check the status of the SVO (85*) in ${TRef.crm} (customer may have either the CCT number or the SVO number as reference)
        <ul>
            <li>On the SVO, under Items &raquo; Actions select the edit button for Item Number 10</li>
            <li>Under Assignments, verify Start Date (indicates when the order was dispatched) and check Start Time/End Time</li>
            <li>If Start Time is 20:00 and End Time is 21:00 (8:00 pm&ndash;9:00 pm), the visit likely hasn't been scheduled</li>
        </ul>
    </li>
    <li>Use the <a href="#" onclick="manualOverlay('fse-update');">FSE Status Inquiry</a> email template. You'll need to provide:
        <ul>
            <li>Point of Contact (POC) Name</li>
            <li>POC Phone Number</li>
            <li>POC Email</li>
            <li>The SVO Number and creation date for the SVO (in pop-up)</li>
        </ul>
    </li>
    <li>Use the FSE Tool to CC the assignee and the Field Service Supervisor (FSS) for fastest response</li><li>Complete CCT noting that email was sent to the appropriate parties</li>
</ol>`,
                    "pm-request": `<h1>Preventative Maintenance Request (with Service Contract)</h1>
<ol>
    <li>Note the Contract ID in ${TRef.crm}</li>
    <li>Verify the instrument address</li>
    <li>Use the <a href="#" onclick="">Admin PM Request</a> email template</li>
</ol>
For a PM request without a service contract:
<ol>
    <li>Confirm billing (use the <a href="#" onclick="manualOpenEmailTemplate('fse-billing-request')">PO Authorization</a> email request template if needed)</li>
    <li>If billing is authorized verbally or approval/PO is sent to you, create Preventative Maintenance task</li>
    <li>Leave CCT as 'In Process with Follow-Up'</li>
</ol>`,
                    "proaim-pm-request": `<h1>PROAIM Preventative Maintenance Request</h1>
<ol>
    <li>Use <a href="#" onclick="">PROAIM PM Request</a> email template</li>
</ol>`,
                    "review-station-software-install": `<h1>Software Install (Review Station)</h1>
<ol>
    <li>[Recommended] Notify customer that at some point in the future, this type of support may fall under 'Professional Services' and carry a billable rate</li>
    <li>Remotely access review station using TeamViewer</li>
    <li>Use software download link to acquire installation kit, or, if available, have customer connect USB drive with install kit for target software version</li>
    <li>Verify system requirements for the software to be installed</li>
    <li>Uninstall existing software (if performing software upgrade</li>
    <li>Run installer</li>
    <li>Perform any necessary post-install configuration steps</li>
    <li>${TRef.cct_in_crm}, using Call Type 'Remote Service' and including all relevant information</li>
    <li>Set Status to 'In Process'</li>
    <li>Set CCT Processor to 'Vanessa Beliso' (User Name U6VBELIS)</li>
</ol>`,
                    "spare-parts": `<h1>Spare Parts Request</h1>
<ol>
    <li>Check for part description and part number in SIS</li>
    <li>Use <a href="#" onclick="manualOverlay('parts-order')">Parts Order</a> email template</li>
</ol>`
                }
            }
        },
        "solution": {
        },
        "hint": {
        },
        "reminder": {
        },
        "export": {
        }
    }
}    
